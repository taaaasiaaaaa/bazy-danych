

Zadanie 1
SELECT ID_ZESP, NAZWA, ADRES
FROM ZESPOLY Z
WHERE NOT EXISTS (SELECT * FROM PRACOWNICY
WHERE ID_ZESP=Z.ID_ZESP);

Zadanie 2
SELECT NAZWISKO, PLACA_POD
FROM PRACOWNICY
ORDER BY PLACA_POD DESC
OFFSET 5 ROWS
FETCH FIRST 5 ROWS ONLY;
SELECT ROWNUM, T.NAZWISKO, T.PLACA_POD
FROM
(SELECT NAZWISKO, PLACA_POD
FROM PRACOWNICY
ORDER BY PLACA_POD DESC
OFFSET 5 ROWS) T
WHERE ROWNUM <=5

Zadanie 3
WITH prac_zesp AS
(SELECT nazwisko,
placa_pod - (SELECT AVG(PLACA_POD) FROM PRACOWNICY P
WHERE P.ID_ZESP = ID.ID_ZESP) AS roznica
FROM pracownicy JOIN zespoly USING (id_zesp))
SELECT * FROM prac_zesp
WHERE roznica > 0
ORDER BY nazwisko;

Zadanie 4
WITH LATA AS
(SELECT EXTRACT(YEAR FROM zatrudniony) AS rok, COUNT(*) AS liczba
FROM PRACOWNICY
GROUP BY EXTRACT(YEAR FROM zatrudniony))
SELECT * FROM LATA
ORDER BY LICZBA DESC;

Zadanie 5
WITH LATA AS
(SELECT EXTRACT(YEAR FROM zatrudniony) AS rok, COUNT(*) AS liczba
FROM PRACOWNICY
GROUP BY EXTRACT(YEAR FROM zatrudniony))
SELECT * FROM LATA
ORDER BY LICZBA DESC
FETCH FIRST ROW ONLY;

Zadanie 6
WITH ASYSTENCI AS
(SELECT NAZWISKO, ETAT
FROM PRACOWNICY
WHERE ETAT = 'ASYSTENT'),
PIOTROWO AS
(SELECT NAZWA, ADRES
FROM ZESPOLY
WHERE ADRES = 'PIOTROWO 3A')
SELECT A.NAZWISKO, A.ETAT, P.NAZWA, P.ADRES
FROM ASYSTENCI A, PIOTROWO P
WHERE A.ID_ZESP = P.ID_ZESP;

Zadanie 7
WITH zespol AS
(SELECT Z.NAZWA, MAKS_SUMA_PLAC FROM (
SELECT MAX(SUM(PLACA_POD)) AS MAKS_SUMA_PLAC FROM PRACOWNICY
GROUP BY ID_ZESP
) N,
(SELECT ID_ZESP, SUM(PLACA_POD) AS SUMA_PLAC FROM PRACOWNICY
GROUP BY ID_ZESP) S,
ZESPOLY Z
WHERE S.SUMA_PLAC = MAKS_SUMA_PLAC
AND Z.ID_ZESP = S.ID_ZESP)
SELECT * from zespol;

Zadanie 8
1) 
WITH
podwladni (id_prac, id_szefa, nazwisko, pozycja_w_hierarchii) AS
(SELECT id_prac, id_szefa, nazwisko, 1
FROM pracownicy
WHERE nazwisko = 'BRZEZINSKI'
UNION ALL
SELECT p.id_prac, p.id_szefa, p.nazwisko, pozycja_w_hierarchii+1
FROM podwladni s JOIN pracownicy p ON s.id_prac = p.id_szefa)
SEARCH DEPTH FIRST BY nazwisko SET porzadek_potomkow
SELECT nazwisko, pozycja_w_hierarchii
FROM podwladni
ORDER BY porzadek_potomkow;

2) 
SELECT nazwisko, LEVEL AS pozycja_w_hierarchii
FROM pracownicy
CONNECT BY id_szefa = PRIOR id_prac
START WITH nazwisko = 'BRZEZINSKI'
ORDER BY NAZWISKO;